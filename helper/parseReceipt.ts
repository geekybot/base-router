// const buy = require('../test/buyReceipt.json')
const { BigNumber } = require('bignumber.js');
const swapTopic = "0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822";
export function parse(receipt: any) {
    // console.log(receipt)
    receipt = JSON.parse(receipt);
    for (let i = 0; i < receipt.logs.length; i++) {
        if (receipt.logs[i].topics.includes(swapTopic)) {
            const data = receipt.logs[i].data;
            let amounts = parseData(data);
            return amounts;
        }
    }
}
function parseData(data: string) {

    const dataWithoutPrefix = data.slice(2);

    // Slice data into four parts
    const part1 = dataWithoutPrefix.slice(0, 64);
    const part2 = dataWithoutPrefix.slice(64, 128);
    const part3 = dataWithoutPrefix.slice(128, 192);
    const part4 = dataWithoutPrefix.slice(192);

    // Convert each part to BigNumber
    const bigNumber1 = new BigNumber(part1, 16);
    const bigNumber2 = new BigNumber(part2, 16);
    const bigNumber3 = new BigNumber(part3, 16);
    const bigNumber4 = new BigNumber(part4, 16);

    return [bigNumber1.toFixed().toString(), bigNumber2.toFixed().toString(), bigNumber3.toFixed().toString(), bigNumber4.toFixed().toString()];
}


// console.log(
// parse(JSON.stringify({"blockHash":"0xa8998e72b9688a7285631d06d426bd6bf6aa3ea4a077340fd8d30546885f7628","blockNumber":12184969,"contractAddress":null,"cumulativeGasUsed":8231644,"effectiveGasPrice":45139450,"from":"0x6f771127cfbf96c6e29eb587eeade967222459f7","gasUsed":118513,"l1Fee":"0x1109d28b50","l1GasPrice":"0x480fec6d2","l1GasUsed":"0xd6c","logs":[{"address":"0x4200000000000000000000000000000000000006","topics":["0xe1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109c","0x0000000000000000000000004752ba5dbc23f44d87826276bf6fd6b1c372ad24"],"data":"0x00000000000000000000000000000000000000000000000000005af3107a4000","blockNumber":12184969,"transactionHash":"0x3cdeede83035edaa9d74a1e7dc37be7d8dd957cf45a8bfdddec841d54ca370a9","transactionIndex":18,"blockHash":"0xa8998e72b9688a7285631d06d426bd6bf6aa3ea4a077340fd8d30546885f7628","logIndex":2533,"removed":false,"id":"log_1412a81e"},{"address":"0x4200000000000000000000000000000000000006","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000004752ba5dbc23f44d87826276bf6fd6b1c372ad24","0x0000000000000000000000004fed48e33cd094fec5ef367595eece7fa90da066"],"data":"0x00000000000000000000000000000000000000000000000000005af3107a4000","blockNumber":12184969,"transactionHash":"0x3cdeede83035edaa9d74a1e7dc37be7d8dd957cf45a8bfdddec841d54ca370a9","transactionIndex":18,"blockHash":"0xa8998e72b9688a7285631d06d426bd6bf6aa3ea4a077340fd8d30546885f7628","logIndex":2534,"removed":false,"id":"log_a7a10d17"},{"address":"0xB4F2c8B957A9C5d197551a469FCB448F6FfCcd68","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000004fed48e33cd094fec5ef367595eece7fa90da066","0x0000000000000000000000006f771127cfbf96c6e29eb587eeade967222459f7"],"data":"0x00000000000000000000000000000000000000000000057a164b1211b6414a5d","blockNumber":12184969,"transactionHash":"0x3cdeede83035edaa9d74a1e7dc37be7d8dd957cf45a8bfdddec841d54ca370a9","transactionIndex":18,"blockHash":"0xa8998e72b9688a7285631d06d426bd6bf6aa3ea4a077340fd8d30546885f7628","logIndex":2535,"removed":false,"id":"log_f83934e8"},{"address":"0x4fed48E33Cd094FEC5ef367595EEcE7fA90dA066","topics":["0x1c411e9a96e071241c2f21f7726b17ae89e3cab4c78be50e062b03a9fffbbad1"],"data":"0x0000000000000000000000000000000000000000000000001e92fbc708a9c000000000000000000000000000000000000000000001d8bb3933a8947af93872c4","blockNumber":12184969,"transactionHash":"0x3cdeede83035edaa9d74a1e7dc37be7d8dd957cf45a8bfdddec841d54ca370a9","transactionIndex":18,"blockHash":"0xa8998e72b9688a7285631d06d426bd6bf6aa3ea4a077340fd8d30546885f7628","logIndex":2536,"removed":false,"id":"log_5b095d5b"},{"address":"0x4fed48E33Cd094FEC5ef367595EEcE7fA90dA066","topics":["0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822","0x0000000000000000000000004752ba5dbc23f44d87826276bf6fd6b1c372ad24","0x0000000000000000000000006f771127cfbf96c6e29eb587eeade967222459f7"],"data":"0x00000000000000000000000000000000000000000000000000005af3107a40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000057a164b1211b6414a5d","blockNumber":12184969,"transactionHash":"0x3cdeede83035edaa9d74a1e7dc37be7d8dd957cf45a8bfdddec841d54ca370a9","transactionIndex":18,"blockHash":"0xa8998e72b9688a7285631d06d426bd6bf6aa3ea4a077340fd8d30546885f7628","logIndex":2537,"removed":false,"id":"log_f4b24620"}],"logsBloom":"0x00200000000000000000000080000000000000000000000000040000000000000000000000000000000000100000000000800000000000000002000000000000000000008000000000000008000000200000000000000010000000008000000000000020000000000000000000800000000000000000080000000010000000000000000000000000000000000000000000000001022000080000004000000000000000000000000000000000000000000000000000000800000000000000000000000002400100000000000000000000100000000010001000000000000000000000000000000000000000000000000080000000008000400000000000000000","status":true,"to":"0x4752ba5dbc23f44d87826276bf6fd6b1c372ad24","transactionHash":"0x3cdeede83035edaa9d74a1e7dc37be7d8dd957cf45a8bfdddec841d54ca370a9","transactionIndex":18,"type":"0x0"})));